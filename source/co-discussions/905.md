---
title: åœ¨Macç«¯ä½¿ç”¨iverilogå’Œgtkwaveè¿›è¡Œæœ¬åœ°ä»¿çœŸç¼–è¯‘è¿è¡Œ
date: 2024-02-03
mathjax: true
---
<div class="post-info">
<span>FyVoid</span>
|
<abbr title="2023-09-05T19:44:43.695714+08:00"><time datetime="2023-09-05T19:44:43.695714+08:00">2023-09-05 19:44:43</time></abbr>
|
<span>â­ï¸ 3</span>
|
<span>ğŸ’¬ï¸ 6</span>
<br>
<div><div class="post-tag">åˆ†äº«</div><div class="post-tag">Verilog</div></div>
</div>

<div id="reply-3472" class="reply reply-l0">
<div class="reply-header">
<span>FyVoid</span>
<div class="reply-verified">åŠ©æ•™è®¤è¯</div>
</div>
<div class="reply-text">

> **iverilog**å’Œ**gtkwave**å‡ä¸ºè·¨å¹³å°å¼€æºå·¥å…·ï¼Œè¿›è¡Œé…ç½®åæœ¬æ•™ç¨‹åŒæ ·é€‚ç”¨äºwindowså’Œlinuxå¹³å°

ç”±äºåœ¨Macç«¯æ— æ³•ä½¿ç”¨ISEå’ŒVCSï¼Œæˆ‘åœ¨æœç´¢åæ‰¾åˆ°äº†iverilogå’Œgtkwaveä½œä¸ºMacç«¯åŸç”Ÿç¼–è¯‘å’Œè¿è¡Œè°ƒè¯•verilogçš„å·¥å…·ï¼Œåœ¨æ­¤åšä¸€ä¸ªåˆ†äº«ï¼ˆç¼–è¾‘å™¨é‡‡ç”¨VSCodeï¼‰ã€‚

## ç¯å¢ƒé…ç½®

é¦–å…ˆï¼Œä½ éœ€è¦**homebrew**æ¥å®‰è£…è¿™äº›å·¥å…·ï¼Œå¦‚æœä½ æ²¡æœ‰å®‰è£…homebrewå¯ä»¥å‚è€ƒè¿™ä¸ªåšå®¢ã€‚

> https://zhuanlan.zhihu.com/p/146001246

è¿›å…¥terminalåè¾“å…¥ä»¥ä¸‹å‘½ä»¤

* å®‰è£…iverilogï¼š

```
brew install icarus-verilog
```

* å®‰è£…gtkwaveï¼š

```
brew install caskroom/cask/gtkwave
```

## ç¼–å†™å’Œè¿è¡Œverilogä»£ç 

ç¡®è®¤å·²ç»å®‰è£…å¥½éœ€è¦çš„å·¥å…·åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™verilogä»£ç äº†ã€‚ï¼ˆæ­¤å¤„ä»¥æ•™ç¨‹ä¸­æ—¶åºç”µè·¯ç»ƒä¹ _1 ç¼–å·ï¼š1109-400ä¸ºä¾‹ï¼‰

é¦–å…ˆï¼Œåœ¨vscodeä¸­æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œç›®å½•ä¸­æ–°å»ºæ–‡ä»¶counter.vç”¨äºç¼–å†™counteræ¨¡å— 

> vscodeä¸­å¯ä»¥è‡ªå·±æœç´¢å¹¶å®‰è£…verilogç›¸å…³æ‰©å±•æä¾›ä»£ç è¡¥å…¨å’Œé«˜äº®ï¼Œæˆ‘ç›®å‰ä½¿ç”¨çš„æ˜¯
>
> Verilog-HDL/SystemVerilog/Bluespec SystemVerilog
>
> ä¸æ˜¯å¤ªå¥½ç”¨

counter.v å†…å®¹ï¼ˆå¹¶éæœ€ä½³å®ç°ï¼‰ï¼š

```
module counter(
    input[1:0] num,
    input clk,
    output ans
);

    reg[1:0] Status;

    initial begin
        Status = 2'b00;
    end

    always @(posedge clk) begin
        case(Status)
            2'b00: begin
                case(num)
                    2'b01: Status <= 2'b01;
                    2'b10: Status <= 2'b00;
                    2'b11: Status <= 2'b00;
                endcase
            end
            2'b01: begin
                case(num)
                    2'b01: Status <= 2'b01;
                    2'b10: Status <= 2'b10;
                    2'b11: Status <= 2'b00;
                endcase
            end
            2'b10: begin
                case(num)
                    2'b01: Status <= 2'b01;
                    2'b10: Status <= 2'b00;
                    2'b11: Status <= 2'b11;
                endcase
            end
        endcase
    end

    assign ans = Status == 2'b11 ? 1 : 0;

endmodule
```

ç¼–å†™å®Œæˆåï¼Œåœ¨ç›®å½•ä¸­æ–°å»ºcounter_tb.v ç”¨äºç¼–å†™testbench

counter_tb.v å†…å®¹ï¼š

```
module counter_tb;

    reg clk;
    reg[31:0] input_nums;
    wire[1:0] num;
    reg[1:0] in_num;
    wire ans;
    reg in_count;

    counter c(num, clk, ans);
    
    initial begin
        input_nums = 32'b01_01_11_10_10_01_10_11_11_10_11_10_01_01_10_01;
        clk = 0;
        in_num = 2'b00;
    end

    /*iverilog */
    initial
    begin            
        $dumpfile("wave.vcd");        //ç”Ÿæˆçš„vcdæ–‡ä»¶åç§°
        $dumpvars(0, counter_tb);     //tbæ¨¡å—åç§°
    end
    /*iverilog */
    
    always 
    #5 clk = ~clk;

    always @(posedge clk) begin
        if(input_nums == 32'b0)
            $finish;
        in_num <= input_nums[31:30];
        input_nums = input_nums << 2;
    end

    assign num = in_num;
    
endmodule
```

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨terminalæ‰‹åŠ¨è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆæ³¢å½¢æ–‡ä»¶ï¼Œå¹¶ç”¨gtkwaveæŸ¥çœ‹ç”Ÿæˆçš„æ³¢å½¢ã€‚

#### ç¼–è¯‘

åœ¨terminalè¾“å…¥ï¼š

```
iverilog -o wave counter.v counter_tb.v
```

-oæŒ‡å®šç”Ÿæˆæ–‡ä»¶çš„åç§°ï¼ˆwaveï¼‰ï¼Œåé¢çš„å‚æ•°è¡¨ç¤ºç¼–è¯‘çš„æºæ–‡ä»¶ï¼Œå®Œæˆç¼–è¯‘åï¼Œå¯ä»¥çœ‹åˆ°ç›®å½•ä¸­å¤šå‡ºäº†waveæ–‡ä»¶

#### ç”Ÿæˆæ³¢å½¢æ–‡ä»¶

è¾“å…¥ï¼š

```
vvp -n wave -lxt2
```

è¿è¡Œåï¼Œå¯ä»¥çœ‹åˆ°ç›®å½•äº§ç”Ÿäº†wave.vcdæ–‡ä»¶

#### ç”¨gtkwaveæŸ¥çœ‹æ³¢å½¢

gtkwaveå¯ä»¥**ç›´æ¥æ‰“å¼€è½¯ä»¶**ï¼Œæ‰“å¼€æ³¢å½¢æ–‡ä»¶æŸ¥çœ‹ã€‚

æ›´æ¨èçš„åšæ³•æ˜¯ï¼Œåœ¨terminalè¾“å…¥gtkwave wave.vcd

å¦‚å›¾ï¼Œgtkwaveä¸­å°±å¯ä»¥æŸ¥çœ‹ä»¿çœŸçš„æ³¢å½¢ï¼Œå¯ä»¥çœ‹åˆ°å’Œé¢„æƒ³çš„ç»“æœä¸€è‡´ã€‚

![gtkwave.png](/images/co-discussions/905/gtkwave.png)

## å·æ‡’

*ç¨‹åºå‘˜è¯ç”Ÿçš„ç›®çš„å°±æ˜¯ä¸ºäº†å·æ‡’ã€‚*

æ—¢ç„¶æˆ‘ä»¬éœ€è¦å¤šä¸ªæ§åˆ¶å°å‘½ä»¤å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œä¸å¦‚å†™ä¸€ä¸ªshellè„šæœ¬æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹

åœ¨ç›®å½•æ–°å»ºä¸€ä¸ªverilog_compile.sh æ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š

```
echo 'start compiling'
iverilog -o wave $*
# å¦‚æœç›´æ¥è¿è¡Œshellè„šæœ¬è¿›è¡Œç¼–è¯‘ï¼Œæ³¨é‡Šæ‰ä¸Šä¸€è¡Œï¼Œä½¿ç”¨ä¸‹ä¸€è¡Œ
# iverilog -o wave # è¿™é‡Œå¡«å…¥éœ€è¦ç¼–è¯‘çš„æ–‡ä»¶
echo 'compiling complete'

echo 'generate wave file'
vvp -n wave -lxt2
# å¦‚æœè¦ç”Ÿæˆlxt æ–‡ä»¶
# cp wave.vcd wave.lxt

echo 'opening wave file'
gtkwave wave.vcd
```

é€šè¿‡åœ¨ç»ˆç«¯å°†è¿™ä¸ªshellè„šæœ¬å½“ä½œç¼–è¯‘å‘½ä»¤ä½¿ç”¨ï¼Œå¯ä»¥ç›´æ¥å®Œæˆä¸Šä¸€èŠ‚çš„æ‰€æœ‰è¿‡ç¨‹ã€‚

![shell_gtkwave.png](/images/co-discussions/905/shell_gtkwave.png)
ä¹Ÿå¯ä»¥ä¿®æ”¹shellè„šæœ¬ä¸­ç›¸å…³éƒ¨åˆ†ï¼Œç›´æ¥åœ¨vscodeä¸­è¿è¡Œshellè„šæœ¬ã€‚

</div>
<div class="reply-footer">
<abbr title="2023-09-05T19:44:43.722763+08:00"><time datetime="2023-09-05T19:44:43.722763+08:00">2023-09-05 19:44:43</time></abbr>
|
<span>ä¿ç•™æ‰€æœ‰æƒåˆ©</span>
<span class="reply-vote">â¤ï¸ 2</span>
</div>
</div>
<hr class="reply-separator">
<div id="reply-3477" class="reply reply-l1">
<div class="reply-header">
<span>???</span>
</div>
<div class="reply-text">

???

</div>
<div class="reply-footer">
<abbr title="2023-09-06T15:50:37.529658+08:00"><time datetime="2023-09-06T15:50:37.529658+08:00">2023-09-06 15:50:37</time></abbr>
|
<span>???</span>
<span class="reply-vote">â¤ï¸ 0</span>
</div>
</div>
<hr class="reply-separator">
<div id="reply-3800" class="reply reply-l1">
<div class="reply-header">
<span>???</span>
</div>
<div class="reply-text">

???

</div>
<div class="reply-footer">
<abbr title="2023-10-12T20:56:34.066116+08:00"><time datetime="2023-10-12T20:56:34.066116+08:00">2023-10-12 20:56:34</time></abbr>
|
<span>???</span>
<span class="reply-vote">â¤ï¸ 0</span>
</div>
</div>
<hr class="reply-separator">
<div id="reply-3802" class="reply reply-l2">
<div class="reply-header">
<span>FyVoid <a href="#reply-3800">å›å¤</a> ???</span>
</div>
<div class="reply-text">

çœ‹èµ·æ¥åƒæ˜¯ä½ è°ƒç”¨å‘½ä»¤çš„ç›®å½•ä¸‹æ²¡æœ‰è¯»å–æ–‡ä»¶çš„æƒé™ï¼Œä½ å¯ä»¥æ›´æ¢åˆ°å…¶ä»–ç›®å½•å°è¯•ä¸€ä¸‹
ä¾‹å¦‚ï¼š
```
~ cd
~ mkdir src
~ cd src
# åœ¨srcç›®å½•ä¸‹è¿›è¡Œå°è¯•
```

</div>
<div class="reply-footer">
<abbr title="2023-10-13T09:57:41.596177+08:00"><time datetime="2023-10-13T09:57:41.596177+08:00">2023-10-13 09:57:41</time></abbr>
|
<span>ä¿ç•™æ‰€æœ‰æƒåˆ©</span>
<span class="reply-vote">â¤ï¸ 0</span>
</div>
</div>
<hr class="reply-separator">
<div id="reply-3803" class="reply reply-l2">
<div class="reply-header">
<span>FyVoid <a href="#reply-3800">å›å¤</a> ???</span>
</div>
<div class="reply-text">

å¦å¤–ï¼Œä½ è¿›è¡Œç¼–è¯‘æ—¶çš„æŠ¥é”™å¯ä»¥çœ‹å‡ºä½ ç°åœ¨çš„ç›®å½•ä¸‹æ²¡æœ‰counter.vè¿™ä¸ªæ–‡ä»¶ï¼Œä½ éœ€è¦å°†æ–‡ä»¶éƒ½æ”¾åˆ°ä½ è°ƒç”¨å‘½ä»¤çš„ç›®å½•ä¸‹

</div>
<div class="reply-footer">
<abbr title="2023-10-13T09:58:41.828928+08:00"><time datetime="2023-10-13T09:58:41.828928+08:00">2023-10-13 09:58:41</time></abbr>
|
<span>ä¿ç•™æ‰€æœ‰æƒåˆ©</span>
<span class="reply-vote">â¤ï¸ 0</span>
</div>
</div>
<hr class="reply-separator">
<div id="reply-3827" class="reply reply-l3">
<div class="reply-header">
<span>???</span>
</div>
<div class="reply-text">

???

</div>
<div class="reply-footer">
<abbr title="2023-10-14T12:19:08.943905+08:00"><time datetime="2023-10-14T12:19:08.943905+08:00">2023-10-14 12:19:08</time></abbr>
|
<span>???</span>
<span class="reply-vote">â¤ï¸ 0</span>
</div>
</div>